<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="DataFrame操作" /><meta name="author" content="刘德智" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="###" /><meta property="og:description" content="###" /><link rel="canonical" href="https://liudezhiya.github.io//posts/DataFrame%E6%93%8D%E4%BD%9C/" /><meta property="og:url" content="https://liudezhiya.github.io//posts/DataFrame%E6%93%8D%E4%BD%9C/" /><meta property="og:site_name" content="番茄智" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-20T03:34:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="DataFrame操作" /><meta name="twitter:site" content="@liudezhi" /><meta name="twitter:creator" content="@刘德智" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"刘德智"},"dateModified":"2022-07-20T03:34:00+00:00","datePublished":"2022-07-20T03:34:00+00:00","description":"###","headline":"DataFrame操作","mainEntityOfPage":{"@type":"WebPage","@id":"https://liudezhiya.github.io//posts/DataFrame%E6%93%8D%E4%BD%9C/"},"url":"https://liudezhiya.github.io//posts/DataFrame%E6%93%8D%E4%BD%9C/"}</script><title>DataFrame操作 | 番茄智</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="番茄智"><meta name="application-name" content="番茄智"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/config/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">番茄智</a></div><div class="site-subtitle font-italic">这里是番茄智的博客～</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/liudezhiya" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/liudezhi" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['2451456574','qq.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>DataFrame操作</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>DataFrame操作</h1><div class="post-meta text-muted"> <span> 发表于 <em class="" data-ts="1658288040" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2022/07/20 </em> </span><div class="d-flex justify-content-between"> <span> 作者 <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3986 字"> <em>22 分钟</em>阅读</span></div></div></div><div class="post-content"><p>###</p><p>[TOC]</p><h3 id="pandas常用的数据查看方法有"><span class="mr-2">pandas常用的数据查看方法有</span><a href="#pandas常用的数据查看方法有" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="table-wrapper"><table><thead><tr><th>方法<th>操作<th>结果<tbody><tr><td>head(n)<td>查看数据集对象的前n行<td>Series或DataFrame<tr><td>tail(n)<td>查看数据集的最后n行<td>Series或DataFrame<tr><td>sample(n)<td>随机查看n个样本<td>Series或DataFrame<tr><td>describe()<td>数据集的统计摘要<td>Series</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">54</span><span class="p">])</span><span class="n">数据</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">54</span><span class="p">:</span><span class="mi">55</span><span class="p">])</span><span class="n">标签</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">54</span><span class="p">])</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">54</span><span class="p">:</span><span class="mi">55</span><span class="p">])</span>
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>操作<th>语法<th>返回结果<tbody><tr><td>选择列<td>df[col]<td>Series<tr><td>按索引选择行<td>df.loc[label]<td>Series<tr><td>按位置选择行<td>df.iloc[loc]<td>Series<tr><td>使用切片选择行<td>df[2:5]<td>DataFrame<tr><td>用表达式筛选行<td>df[bool]<td>DataFrame</table></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>df[0:3] #通过切片检索行数据
df[0:3][['staff_id','staff_name','staff_gender']] #通过列标签索引列表检索列数据

df.loc[1] #标量标签，返回该行标签的Series数据
df.loc[[1,3]] #标签列表，返回标签列表的行DataFrame数据
df.loc[0:3] #切片对象，返回切片的行DataFrame数据
df.loc[0:3,'staff_id':'staff_salary']  #根据行切片，列切片检索数据
df.loc[[0,1,2,3],['staff_id','staff_name','staff_age']] #根据行标签列表，列标签列表检索数据

df.iloc[1]  #整数标量选择，数据从0开始，为1的就是第二行的数据，返回的是Series

df.iloc[[1,3]] #整数列表选择，选择位置为1和3的数据，返回的是DataFrame
df.iloc[1:3] #切片选择，选择位置1至2的数据，不包含边界结束值，也就是不包含3的位置

df.iloc[1:3,1:4] #切片选择位置为1至3的行和1至4的列不含位置为3的行和位置为4的列

df.at['A','staff_name']  #检索第“A”行的列标签为"staff_name"的数据
df.iat[0,1]  #检索第1行第2列的数据


df[(df.staff_salary&gt;10000)&amp;(df.staff_age&lt;40)]  #检索staff_age小于40且staff_salary&gt;10000的数据
df.query('staff_salary&gt;10000 &amp; staff_age&lt;40') #通过函数检索staff_age小于40且staff_salary&gt;10000的数据


</pre></table></code></div></div><h3 id="访问-dataframe-中的单个元素时"><span class="mr-2">访问 DataFrame 中的单个元素时</span><a href="#访问-dataframe-中的单个元素时" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>并且列标签在前，格式为 `dataframe[column][row]
</pre></table></code></div></div><h3 id="读取文件夹下所有文件"><span class="mr-2">读取文件夹下所有文件</span><a href="#读取文件夹下所有文件" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>alldata_filenames=glob.glob(alldata_directory+"\*.csv")
for alldata_filename in alldata_filenames:
#for alldata_filename in os.listdir(alldata_directory):#直接文件名没有带路径
    print(alldata_filename)#带路径
</pre></table></code></div></div><h3 id="以多个划分符分割"><span class="mr-2">以多个划分符分割</span><a href="#以多个划分符分割" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre> import re
 awardnamelinelist=re.split(r'[;, ]]',awardname)
</pre></table></code></div></div><h3 id="将中文姓名转为英文姓名"><span class="mr-2">将中文姓名转为英文姓名</span><a href="#将中文姓名转为英文姓名" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">nametopingying</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">pypinyin</span><span class="p">.</span><span class="n">pinyin</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">pypinyin</span><span class="p">.</span><span class="n">NORMAL</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">result</span><span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">:]).</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></table></code></div></div><h3 id="python对csv去除重复行"><span class="mr-2">python对csv去除重复行</span><a href="#python对csv去除重复行" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>frame=pd.read_csv('E:/bdbk.csv',engine='python')

data = frame.drop_duplicates(subset=['名称'], keep='first', inplace=False)

data.to_csv('E:/baike.csv', encoding='utf8')
</pre></table></code></div></div><p>通常会分为两种情况，一种是去除完全重复的行数据，另一种是去除某几列重复的行数据，就这两种情况可用下面的代码进行处理。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre>

1. 去除完全重复的行数据

data.drop_duplicates(inplace=True)

2. 去除某几列重复的行数据

data.drop_duplicates(subset=['A','B'],keep='first',inplace=True)

subset： 列名，可选，默认为None

keep： {‘first’, ‘last’, False}, 默认值 ‘first’

first： 保留第一次出现的重复行，删除后面的重复行。

last： 删除重复项，除了最后一次出现。

False： 删除所有重复项。

inplace：布尔值，默认为False，是否直接在原数据上删除重复项或删除重复项后返回副本。

( inplace=True表示直接在原来的DataFrame上删除重复项，而默认值False表示生成一个副本。)

DataFrame.drop_duplicates(subset = None, keep = 'first')

DataFrame.drop_duplicates()中的参数完全实现。

其中subset这个参数默认‘None’是指选择所有列，即所有列的值都相同我才认为这两行是重复的，

也可以自定义为其中一部分列变量名，比如subset=['name','sex','age']。

keep参数中'first'和‘last’会根据index的前后产生不同的效果。参数False会去除所有重复行。
</pre></table></code></div></div><p>举个栗子：</p><p>name sex age</p><p>0 coco female 7</p><p>1 lily female 7</p><p>2 joe male 15</p><p>3 coco female 7</p><p>DataFrame.drop_duplicates(subset = None, keep = ‘first’)，产生的结果如下：</p><p>name sex age</p><p>0 coco female 7</p><p>1 lily female 7</p><p>2 joe male 15</p><p>若使用代码DataFrame.drop_duplicates(subset = None, keep = ‘last’)，结果如下：</p><p>name sex age</p><p>1 lily female 7</p><p>2 joe male 15</p><p>3 coco female 7</p><p>发现不考虑index以及行的顺序，效果与参数first相同。</p><p>若使用代码DataFrame.drop_duplicates(subset = None, keep = False), 则把相同的行全部删除，结果如下：</p><p>name sex age</p><p>1 lily female 7</p><p>2 joe male 15</p><p>所有重复的行都被删除，没有保留。</p><p>若使用代码DataFrame.drop_duplicates(subset = [‘sex’ , ‘age’] , keep = False), 结果如下：</p><p>name sex age</p><p>2 joe male 15 ————————————————</p><h3 id="统计重复值并去除相同的元素"><span class="mr-2">统计重复值，并去除相同的元素</span><a href="#统计重复值并去除相同的元素" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>统计</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">参数</span><span class="p">:</span>
<span class="mf">1.</span><span class="n">normalize</span> <span class="p">:</span> <span class="n">boolean</span><span class="p">,</span> <span class="n">default</span> <span class="bp">False</span><span class="err">　</span><span class="n">默认false</span><span class="err">，</span><span class="n">如为true</span><span class="err">，</span><span class="n">则以百分比的形式显示</span>
<span class="mf">2.</span><span class="n">sort</span> <span class="p">:</span> <span class="n">boolean</span><span class="p">,</span> <span class="n">default</span> <span class="bp">True</span><span class="err">　</span><span class="n">默认为true</span><span class="p">,</span><span class="n">会对结果进行排序</span>
<span class="mf">3.</span><span class="n">ascending</span> <span class="p">:</span> <span class="n">boolean</span><span class="p">,</span> <span class="n">default</span> <span class="bp">False</span><span class="err">　</span><span class="n">默认降序排序</span>
<span class="mf">4.</span><span class="n">bins</span> <span class="p">:</span> <span class="n">integer</span><span class="p">,</span> <span class="n">格式</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">意义不是执行计算</span><span class="err">，</span><span class="n">而是把它们分成半开放的数据集合</span><span class="err">，</span><span class="n">只适用于数字数据</span>
<span class="mf">5.</span><span class="n">dropna</span> <span class="p">:</span> <span class="n">boolean</span><span class="p">,</span> <span class="n">default</span> <span class="bp">True</span><span class="err">　</span><span class="n">默认删除na值</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'source'</span><span class="p">,</span> <span class="s">'target'</span><span class="p">]].</span><span class="n">value_counts</span><span class="p">()</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'edge.csv'</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">'source'</span><span class="p">,</span> <span class="s">'target'</span><span class="p">]].</span><span class="n">value_counts</span><span class="p">().</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'source'</span><span class="p">,</span><span class="s">'target'</span><span class="p">,</span><span class="s">'weight'</span><span class="p">]</span><span class="c1">#为统计值加列名
</span></pre></table></code></div></div><p>去重</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="c1">#1. 去除完全重复的行数据
</span><span class="n">data</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">],</span><span class="n">keep</span><span class="o">=</span><span class="s">'first'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#2. 去除某几列重复的行数据
</span><span class="n">data</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">],</span><span class="n">keep</span><span class="o">=</span><span class="s">'first'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">subset</span><span class="err">：</span> <span class="n">列名</span><span class="err">，</span><span class="n">可选</span><span class="err">，</span><span class="n">默认为None</span>

<span class="n">keep</span><span class="err">：</span> <span class="p">{</span><span class="err">‘</span><span class="n">first</span><span class="err">’</span><span class="p">,</span> <span class="err">‘</span><span class="n">last</span><span class="err">’</span><span class="p">,</span> <span class="bp">False</span><span class="p">},</span> <span class="n">默认值</span> <span class="err">‘</span><span class="n">first</span><span class="err">’</span>

    <span class="n">first</span><span class="err">：</span> <span class="n">保留第一次出现的重复行</span><span class="err">，</span><span class="n">删除后面的重复行</span><span class="err">。</span>
    <span class="n">last</span><span class="err">：</span> <span class="n">删除重复项</span><span class="err">，</span><span class="n">除了最后一次出现</span><span class="err">。</span>
    <span class="bp">False</span><span class="err">：</span> <span class="n">删除所有重复项</span><span class="err">。</span>

<span class="n">inplace</span><span class="err">：</span><span class="n">布尔值</span><span class="err">，</span><span class="n">默认为False</span><span class="err">，</span><span class="n">是否直接在原数据上删除重复项或删除重复项后返回副本</span><span class="err">。（</span><span class="n">inplace</span><span class="o">=</span><span class="n">True表示直接在原来的DataFrame上删除重复项</span><span class="err">，</span><span class="n">而默认值False表示生成一个副本</span><span class="err">。）</span>
</pre></table></code></div></div><p>更换列名</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre># 更换列名，同时显示出来
df.rename(columns={'a':'A'}, inplace=Ture)
# 更换列名，不显示出来 inplace = False(默认)

读入不要索引
df = pd.read_csv(alldata_filename,index_col=0)
写入不要列名
df_author.to_csv('author.csv', index=False)
</pre></table></code></div></div><p>导出加时间</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>import time
timestr = time.strftime("%Y%m%d-%H%M%S")  # 20220715-085113
</pre></table></code></div></div><p>内存溢出</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>方法一：扩充虚拟内存
1、打开 控制面板；
2、找到 系统 这一项；
3、找到 高级系统设置 这一项；
4、点击 性能 模块的 设置 按钮；
5、选择 高级面板，在 虚拟内存 模块点击更改；
6、记得 不要 选中“自动管理所有驱动器的分页文件大小”，然后选择一个驱动器，也就是一个盘，选中自定义大小，手动输入初始大小和最大值，当然，最好不要太大，更改之后能在查看盘的使用情况，不要丢掉太多空间。
7、都设置好之后，记得点击 “设置”， 然后再确定，否则无效，最后 重启电脑 就可以了。

方法二：修改pycharm的运行内存

Help-&gt;Find Action-&gt;(type “VM Options”)-&gt;(Click)“Edit Custom VM Options” 打开pycharm64.exe.vmoptions进行编辑
修改-Xmx750m 为 -Xmx4096m 分配4G内存，视情况而定。保存并重启pycharm

自己的是-Xmx1773m改为-Xmx4096m

</pre></table></code></div></div><p>csv文件连接</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">outfile</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span>  <span class="n">left_on</span><span class="o">=</span><span class="s">'df1_id'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s">'df2_id'</span><span class="p">)</span>
<span class="c1">#文件合并 left_on左侧DataFrame中的列或索引级别用作键。right_on 右侧
</span>
<span class="n">参数how有四个选项</span><span class="err">，</span><span class="n">分别是</span><span class="err">：</span><span class="n">inner</span><span class="err">、</span><span class="n">outer</span><span class="err">、</span><span class="n">left</span><span class="err">、</span><span class="n">right</span>
<span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dataframe_1</span><span class="p">,</span><span class="n">dataframe_2</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">"inner"</span><span class="p">)</span>

<span class="n">内连接</span>
<span class="n">inner是merge函数的默认参数</span><span class="err">，</span><span class="n">意思是将dataframe_1和dataframe_2两表中主键一致的行保留下来</span><span class="err">，</span><span class="n">然后合并列</span><span class="err">。</span>
<span class="n">外连接</span>
<span class="n">outer是相对于inner来说的</span><span class="err">，</span><span class="n">outer不会仅仅保留主键一致的行</span><span class="err">，</span><span class="n">还会将不一致的部分填充Nan然后保留下来</span><span class="err">。</span>
<span class="n">left</span><span class="err">、</span><span class="n">right</span> <span class="n">左连接</span><span class="err">，</span><span class="n">右连接</span>
</pre></table></code></div></div><h3 id="pycharm提示内存不足的解决方法"><span class="mr-2">pycharm提示内存不足的解决方法</span><a href="#pycharm提示内存不足的解决方法" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>点击 Pycharm 菜单栏的 Help-&gt;Edit Custom VM Options进入 pycharm64.exe.vmoptions 文件
或者直接用记事本打开 C:\Users\Administrator\.PyCharm2017.2\config\pycharm64.exe.vmoptions

-Xmx 是运行时的可用的内存大小，默认是 -Xmx750m，可根据实际需要调大一些，
建议改成 -Xmx1024m
</pre></table></code></div></div><h2 id="解决报错dtypewarning-columns-2-have-mixed-types"><span class="mr-2">解决报错DtypeWarning: Columns (2) have mixed types</span><a href="#解决报错dtypewarning-columns-2-have-mixed-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>添加low_memory参数</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>df_question = pd.read_csv("D:/data/final/question20181201.csv",usecols=[2,4,15],low_memory=False)
</pre></table></code></div></div><p>注：其中的usecols参数是读取csv第几列的意思，只需要读取有用字段就OK啦。</p><p>二、问题解决</p><p>按照警告的提示，解决方法有两种：关闭 low_memory 模式或者指定列的数据类型。</p><p>1.关闭 low_memory</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>data = pd.read_csv(f, low_memory=False)
</pre></table></code></div></div><p>2.指定类型（推荐）</p><p>例如我这里把这些列都让 Pandas 看作是 str：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>data = pd.read_csv(f, dtype={"site": str, "aqi": str})
</pre></table></code></div></div><p>三、low_memory 是什么</p><p>Pandas 在读取 csv 文件时时按块读取的，并不会一次性读取，并且对于数据的类型“都靠猜”，所以就可能出现了 Pandas 在不同块对同一列的数据“猜”出了不同的数据类型，也就造成了上述的警告。</p><p>而如果关闭 low_memory 功能时，Pandas 就会一次性读取 csv 中德所有数据，自然对列的数据类型也只会猜测一次，就不会造成这种警告了。但是关闭 low_memory 时，一旦 csv 文件过大，就会内存溢出，所以建议采取指定类型的方式。</p><p><strong>DataFrame转list</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">lable</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">108</span><span class="p">].</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">108</span><span class="p">]</span>
<span class="n">te</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">108</span><span class="p">]</span>
<span class="n">lable_te</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_index</span><span class="p">,</span><span class="mi">108</span><span class="p">].</span><span class="n">tolist</span><span class="p">()</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="n">data_w_2</span> <span class="o">=</span> <span class="n">data_w</span><span class="p">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span><span class="c1">#取下标为3、5的行，0、1、2、5的列
</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_w_2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:]))</span><span class="c1">#类型为DataFrame
</span><span class="n">dm1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_w_2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:])</span><span class="c1">#用np.array将DataFrame转成ndarray
</span><span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dm1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">dm1</span><span class="p">)</span>
<span class="n">dm1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_w_2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:]).</span><span class="n">tolist</span><span class="p">()</span><span class="c1">#再用.tolist()将ndarray转成list
</span><span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dm1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">dm1</span><span class="p">)</span>
<span class="n">dm1</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_w_2</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:]).</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="c1">#由于上面的列表结果仍多包含一个列表，故采用此种方式取到单个列表
</span><span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dm1</span><span class="p">))</span><span class="c1">#至于为什么包裹了多个列表没有去细想
</span><span class="k">print</span><span class="p">(</span><span class="n">dm1</span><span class="p">)</span>


<span class="c1">#返回结果
</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">pandas</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">DataFrame</span><span class="s">'&gt;
&lt;class '</span><span class="n">numpy</span><span class="p">.</span><span class="n">ndarray</span><span class="s">'&gt;
[[ 0.45   0.199 14.3  ]]
&lt;class '</span><span class="nb">list</span><span class="s">'&gt;
[[0.45, 0.199, 14.3]]
&lt;class '</span><span class="nb">list</span><span class="s">'&gt;
[0.45, 0.199, 14.3]
</span></pre></table></code></div></div><h1 id="某一列中每一行拆分成多行">某一列中每一行拆分成多行</h1><ul><li>将需要拆分的数据使用split拆分工具拆分，并使用expand功能拆分成多列<li>将拆分后的多列数据进行列转行操作(stack)，合并成一列<li>将生成的复合索引重新进行reset保留原始的索引,并命名<li>将上面处理后的DataFrame和原始DataFrame进行join操作，默认使用的是索引进行连接</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">year</span><span class="o">=</span><span class="s">'2018'</span>
<span class="n">alldata_award</span><span class="o">=</span><span class="s">'G://BaiduNetdiskDownload//135数据//18-22文件合并//'</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s">'//alldata_award_'</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s">'.csv'</span>
<span class="n">info</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">alldata_award</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">)</span>
<span class="n">info_name</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">'authors'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">info_name</span><span class="o">=</span><span class="n">info_name</span><span class="p">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">info_name</span><span class="o">=</span><span class="n">info_name</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">info_new</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'authors'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">join</span><span class="p">(</span><span class="n">info_name</span><span class="p">)</span>
<span class="n">整合</span>
<span class="n">info_new</span><span class="o">=</span><span class="n">info</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'authors'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">join</span><span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s">'authors'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">stack</span><span class="p">().</span><span class="n">reset_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">rename</span><span class="p">(</span><span class="s">'author'</span><span class="p">))</span>
<span class="n">info_new</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'G://data//findnodeoutput//alldata_award_'</span><span class="o">+</span><span class="n">year</span><span class="o">+</span><span class="s">'.csv'</span><span class="p">)</span>
</pre></table></code></div></div><p>如果原数据中已经是list了，可以将<code class="language-plaintext highlighter-rouge">info[‘city’].str.split(’ ', expand=True)</code>这部分替换成<code class="language-plaintext highlighter-rouge">info[‘city’].apply(lambda x: pd.Series(x))</code></p><h3 id="文件读写"><span class="mr-2">文件读写</span><a href="#文件读写" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>加列名</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre> f2 = open('G://data//findnodeoutput//NamePaperProject_safe.csv', 'w', encoding='utf-8', newline='')
    writer = csv.writer(f2)
    # 指定文件列名
    writer.writerow(
        ['p_index', 'alldata_uuid', 'proJName', 'projId', 'typeCode', 'projType', 'admin', 'supportNum', 'timeScope',
         'approveYear', 'finishYear', 'dependUnit', 'keyWords', 'abstractCh', 'abstractEn', 'conclusionAbstract',
         'alldatafilename', 'alldatafileid', 'index', 'award_uuid', 'award_name', 'award_type', 'authors', 'unknown',
         'awardfilename'])
</pre></table></code></div></div><p>不要index索引,title列名</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>index=None,header=None
写入文件间隔
newline=''
</pre></table></code></div></div><h3 id="文本筛选行contains和isin"><span class="mr-2">文本筛选行contains和isin</span><a href="#文本筛选行contains和isin" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>筛选proJName列含有安全的</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>1
year=str(2018)
alldata_award = 'G://BaiduNetdiskDownload//135数据//18-22文件合并//' + year + '//alldata_award_' + year + '.csv'
df = pd.read_csv(alldata_award, encoding='utf-8')
data=df[df['proJName'].str.contains('安全')]
print(data['proJName'])#7621                    组合构型及其在信息安全中的应用

2
import pandas as pd
df = {'地址':['北京','上海','长沙','北京省会','广州市区'],'table':['user','student','course','sc','book']}
df = pd.DataFrame(df)
print(df)
print('================')
citys = ['北京', '天津', '上海']
address = '|'.join(citys)
df_new = df[df['地址'].str.contains(address)]
print(df_new)#输出含有address城市的行
</pre></table></code></div></div><h3 id="重置列索引"><span class="mr-2">重置列索引</span><a href="#重置列索引" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">temp</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p>安装年份求平均值</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">temp</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'年份'</span><span class="p">).</span><span class="n">mean</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="归一化"><span class="mr-2">归一化</span><a href="#归一化" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre># 将整型变为float
dataset = dataset.astype('float32')
#对数据集合进行标准化
scaler = MinMaxScaler(feature_range=(0, 1))
</pre></table></code></div></div><h1 id="python中逐行遍历dataframe">python中逐行遍历Dataframe</h1><p>​ <strong>1、iterrows()方法</strong></p><p>逐行迭代，将DataFrame的每一行迭代成(index, Series)对，可以通过row[name]访问。</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="n">in</span> <span class="n">df</span><span class="mf">.</span><span class="nf">iterrows</span><span class="p">()</span><span class="o">:</span>
    <span class="k">print</span> <span class="n">row</span><span class="p">[</span><span class="s2">"c1"</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">"c2"</span><span class="p">]</span>
</pre></table></code></div></div><p>​ <strong>2、itertuples()方法</strong></p><p>逐行迭代，将DataFrame的每一行作为一个元组进行迭代，可以通过row[name]访问元素，比iterrows()效率更高。</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">row</span> <span class="n">in</span> <span class="n">df</span><span class="mf">.</span><span class="nf">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Pandas'</span><span class="p">)</span><span class="o">:</span>
    <span class="k">print</span> <span class="nf">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">"c1"</span><span class="p">),</span> <span class="nf">getattr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="s2">"c2"</span><span class="p">)</span>
</pre></table></code></div></div><p>​ <strong>3、iteritems()方法</strong></p><p>按列遍历，将DataFrame的每一列迭代成（列名，系列）对，可以通过row[index]访问。</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">row</span> <span class="n">in</span> <span class="n">df</span><span class="mf">.</span><span class="nf">iteritems</span><span class="p">()</span><span class="o">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
<span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">row</span> <span class="n">in</span> <span class="n">df</span><span class="mf">.</span><span class="nf">iteritems</span><span class="p">()</span><span class="o">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="k">for</span> <span class="n">date</span><span class="p">,</span> <span class="n">row</span> <span class="n">in</span> <span class="n">df</span><span class="mf">.</span><span class="nf">iteritems</span><span class="p">()</span><span class="o">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></table></code></div></div><h3 id="将字典转为dataframe"><span class="mr-2">将字典转为dataframe</span><a href="#将字典转为dataframe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">node_degree</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'degree'</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'index'</span><span class="p">:</span><span class="s">'name'</span><span class="p">})</span>
</pre></table></code></div></div><h3 id="pandas-dataframe-两列转字典"><span class="mr-2">pandas dataframe 两列转字典</span><a href="#pandas-dataframe-两列转字典" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>d = dict(zip(df['A'],df['B']))
import pandas as pd
import numpy as np

test_dict = {'id':[1,2,3,4,5,6],'name':['Alice','Bob','Cindy','Eric','Helen','Grace '],'gender':[0,1,0,1,0,0],
             'math':[90,89,99,78,97,93]}
df = pd.DataFrame.from_dict(test_dict)

print(df)
'''
   id    name  gender  math
0   1   Alice       0    90
1   2     Bob       1    89
2   3   Cindy       0    99
3   4    Eric       1    78
4   5   Helen       0    97
5   6  Grace        0    93
'''

dict(zip(df['id'],df['math']))
# {1: 90, 2: 89, 3: 99, 4: 78, 5: 97, 6: 93}

</pre></table></code></div></div><p>方法二：将A设为索引后，转字典</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>d = df.set_index('A')['B'].to_dict()
d = df.set_index('name')['degree'].to_dict()
#{'张俊伟': [92, 18, 16, 16], '马建峰': [68, 34, 56, 56]
</pre></table></code></div></div><p>实际问题中，常需要将原始表df，按某种方式聚合得到df2，需要得到df2的两列字典。可以直接联合使用 聚合groupby，agg和to_dict函数。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>d = df.groupby('A')['B'].mean().to_dict()

d = df.groupby('gender')['math'].mean().to_dict()
# {0: 94.75, 1: 83.5}
</pre></table></code></div></div><p>eval</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>	<span class="n">a</span>	       <span class="n">b</span>	        <span class="n">c</span>	        <span class="n">d</span>
<span class="mi">0</span>	<span class="mf">0.352100</span>	<span class="mf">0.660768</span>	<span class="mf">0.259112</span>	<span class="mf">0.190435</span>
<span class="mi">1</span>	<span class="mf">0.438345</span>	<span class="mf">0.147769</span>	<span class="mf">0.702476</span>	<span class="mf">0.503706</span>
<span class="mi">2</span>	<span class="mf">0.214064</span>	<span class="mf">0.440153</span>	<span class="mf">0.700988</span>	<span class="mf">0.029637</span>
<span class="mi">3</span>	<span class="mf">0.646761</span>	<span class="mf">0.539095</span>	<span class="mf">0.980113</span>	<span class="mf">0.921489</span>
<span class="mi">4</span>	<span class="mf">0.747330</span>	<span class="mf">0.260352</span>	<span class="mf">0.191178</span>	<span class="mf">0.002823</span>
<span class="mi">5</span>	<span class="mf">0.969599</span>	<span class="mf">0.163768</span>	<span class="mf">0.018234</span>	<span class="mf">0.458367</span>


<span class="n">df</span><span class="p">[</span><span class="s">'e'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'a'</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s">'b'</span><span class="p">]</span><span class="o">+</span><span class="n">df</span><span class="p">[</span><span class="s">'c'</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s">'d'</span><span class="p">];</span>
<span class="n">df</span><span class="p">.</span><span class="nb">eval</span><span class="p">(</span><span class="s">'e=a*c+b*d'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="p">[</span><span class="n">Out</span><span class="p">]</span><span class="err">：</span>
	<span class="n">a</span>	        <span class="n">b</span>        	<span class="n">c</span>	        <span class="n">d</span>      	    <span class="n">e</span>
<span class="mi">0</span>	<span class="mf">0.352100</span>	<span class="mf">0.660768</span>	<span class="mf">0.259112</span>	<span class="mf">0.190435</span>	<span class="mf">0.217067</span>
<span class="mi">1</span>	<span class="mf">0.438345</span>	<span class="mf">0.147769</span>	<span class="mf">0.702476</span>	<span class="mf">0.503706</span>	<span class="mf">0.382359</span>
<span class="mi">2</span>	<span class="mf">0.214064</span>	<span class="mf">0.440153</span>	<span class="mf">0.700988</span>	<span class="mf">0.029637</span>	<span class="mf">0.163101</span>
<span class="mi">3</span>	<span class="mf">0.646761</span>	<span class="mf">0.539095</span>	<span class="mf">0.980113</span>	<span class="mf">0.921489</span>	<span class="mf">1.130668</span>
<span class="mi">4</span>	<span class="mf">0.747330</span>	<span class="mf">0.260352</span>	<span class="mf">0.191178</span>	<span class="mf">0.002823</span>	<span class="mf">0.143608</span>
<span class="mi">5</span>	<span class="mf">0.969599</span>	<span class="mf">0.163768</span>	<span class="mf">0.018234</span>	<span class="mf">0.458367</span>	<span class="mf">0.092746</span>
</pre></table></code></div></div><h3 id="python读取mat文件处理"><span class="mr-2">python读取.mat文件处理</span><a href="#python读取mat文件处理" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>直接读取</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="n">scio</span>
<span class="c1">#注意带路劲
</span><span class="n">data_path</span><span class="o">=</span><span class="s">'D:\workspace\MachineLearning_HW_CQUT\HW3 SVM\data1.mat'</span>
<span class="n">data</span><span class="o">=</span> <span class="n">scio</span><span class="p">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">data_train_data</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'X'</span><span class="p">)</span><span class="c1">#取出字典里的data  &lt;class 'numpy.ndarray'&gt;
</span><span class="n">data_train_label</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'y'</span><span class="p">)</span><span class="c1">#取出字典里的label  &lt;class 'numpy.ndarray'&gt;
</span><span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_train_label</span><span class="p">))</span>


<span class="p">[</span><span class="mf">0.9044</span>   <span class="mf">3.0198</span>  <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.76615</span>  <span class="mf">2.5899</span>  <span class="p">]</span>
 <span class="p">[</span><span class="mf">0.086405</span> <span class="mf">4.1045</span>  <span class="p">]]</span>
<span class="p">[[</span><span class="mi">1</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></table></code></div></div><p>将.mat转为dataframe</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">data_path</span><span class="o">=</span><span class="s">'D:\workspace\MachineLearning_HW_CQUT\HW3 SVM\data1.mat'</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">loadmat</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
<span class="n">dfdata</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">'X'</span><span class="p">][:],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'d1'</span><span class="p">,</span> <span class="s">'d2'</span><span class="p">]).</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">dfdata</span><span class="p">[</span><span class="s">'d1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfdata</span><span class="p">[</span><span class="s">'d1'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'['</span><span class="p">,</span> <span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">']'</span><span class="p">,</span> <span class="s">''</span><span class="p">))</span>
<span class="n">dfdata</span><span class="p">[</span><span class="s">"d2"</span><span class="p">]</span> <span class="o">=</span> <span class="n">dfdata</span><span class="p">[</span><span class="s">'d2'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">'['</span><span class="p">,</span> <span class="s">''</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">']'</span><span class="p">,</span> <span class="s">''</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">dfdata</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>

<span class="p">[[</span><span class="s">'1.9643'</span> <span class="s">'4.5957'</span><span class="p">]</span>
 <span class="p">[</span><span class="s">'2.2753'</span> <span class="s">'3.8589'</span><span class="p">]</span>
 <span class="p">[</span><span class="s">'2.9781'</span> <span class="s">'4.5651'</span><span class="p">]</span>
</pre></table></code></div></div><p>转为数字</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">train_data</span><span class="p">[</span><span class="s">"放牧小区（plot）"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">"放牧小（plot）"</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'category'</span><span class="p">).</span><span class="n">cat</span><span class="p">.</span><span class="n">codes</span>

<span class="n">train_data</span><span class="p">[</span><span class="s">"放牧强度（intensity）"</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">"（intensity）"</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'category'</span><span class="p">).</span><span class="n">cat</span><span class="p">.</span><span class="n">codes</span>
</pre></table></code></div></div><h2 id="python生成随机数"><span class="mr-2">python生成随机数</span><a href="#python生成随机数" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="一python自带的random模块"><span class="mr-2">一、python自带的random模块</span><a href="#一python自带的random模块" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>python标准库中的<code class="language-plaintext highlighter-rouge">random</code>函数，可以生成随机浮点数、整数、字符串，甚至帮助你随机选择列表序列中的一个元素，打乱一组数据。</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">)</span> <span class="c1">#生成一个n到m之间的随机数
</span><span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span>  <span class="c1">#生成一个0到1之间的浮点数
</span><span class="n">random</span><span class="p">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">20</span><span class="p">)</span><span class="c1">#生成不重复的 生成0~20之间的20个随机整数：
</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">)</span> <span class="c1">#生成一个n到m之间的浮点数
</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">([])</span>  <span class="c1">#从列表之间随机选取一个数
</span><span class="n">random</span><span class="p">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#生成一个正态分布的随机数，均值为 5， 标准差为 1
</span><span class="n">random</span><span class="p">.</span><span class="n">expovariate</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span> <span class="c1">#生成一个指数分布的随机数，均值为 5
</span></pre></table></code></div></div><h2 id="二numpy模块生成随机数"><span class="mr-2">二、numpy模块生成随机数</span><a href="#二numpy模块生成随机数" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">rand</span><span class="err">（）</span><span class="c1">#产生N维的均匀分布的随机数
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="err">（）</span><span class="c1">#产生n维的正态分布的随机数
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="c1">#产生n--m之间的k个整数
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">random</span><span class="p">()</span><span class="c1">#产生n个0--1之间的随机数
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="c1">#生成 [1, 10] 内的均匀分布随机数， 2 行 2 列
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#生成一个正态分布的随机数，均值为 5， 标准差为 1， 2 行 2 列
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">poisson</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#生成一个泊松分布的随机数，均值为 5， 2 行 2 列
</span>    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="n">生成一个指数分布的随机数</span><span class="err">，</span><span class="n">均值为</span> <span class="mi">5</span><span class="err">，</span> <span class="mi">2</span> <span class="n">行</span> <span class="mi">2</span> <span class="n">列</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%E9%9A%8F%E7%AC%94/'>随笔</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/%E5%88%86%E7%B1%BB/" class="post-tag no-text-decoration" >分类</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DataFrame%E6%93%8D%E4%BD%9C+-+%E7%95%AA%E8%8C%84%E6%99%BA&url=https%3A%2F%2Fliudezhiya.github.io%2F%2Fposts%2FDataFrame%25E6%2593%258D%25E4%25BD%259C%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DataFrame%E6%93%8D%E4%BD%9C+-+%E7%95%AA%E8%8C%84%E6%99%BA&u=https%3A%2F%2Fliudezhiya.github.io%2F%2Fposts%2FDataFrame%25E6%2593%258D%25E4%25BD%259C%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fliudezhiya.github.io%2F%2Fposts%2FDataFrame%25E6%2593%258D%25E4%25BD%259C%2F&text=DataFrame%E6%93%8D%E4%BD%9C+-+%E7%95%AA%E8%8C%84%E6%99%BA" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/gephi%E4%BD%9C%E8%80%85%E7%BD%91%E7%BB%9C%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96/">java基础总结</a><li><a href="/posts/hello/">复杂网络概念</a><li><a href="/posts/java%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93/">java基础总结</a><li><a href="/posts/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a><li><a href="/posts/matlab/">matlab</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E5%88%86%E7%B1%BB/">分类</a> <a class="post-tag" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/%E5%B0%8F%E6%B3%A2%E5%8F%98%E6%8D%A2/"><div class="card-body"> <em class="small" data-ts="1648262040" data-df="YYYY/MM/DD" > 2022/03/26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>小波变换</h3><div class="text-muted small"><p> 西储大学数据集解读 数据格式：轴承故障数据文件为Matlab格式 DE - drive end accelerometer data 驱动端振动数据 FE - fan end accelerometer data 风扇端振动数据 BA - base accelerometer data 基座振动数据 time - time series data ...</p></div></div></a></div><div class="card"> <a href="/posts/gephi%E4%BD%9C%E8%80%85%E7%BD%91%E7%BB%9C%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E6%8F%90%E5%8F%96/"><div class="card-body"> <em class="small" data-ts="1648262040" data-df="YYYY/MM/DD" > 2022/03/26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>java基础总结</h3><div class="text-muted small"><p> # import pandas as pd import networkx as nx #提取姓名列表 def nameToRow(file,row): data = pd.read_csv(file) x = data[row].tolist() for i in range(len(x)): name_list = str(x[i]).split...</p></div></div></a></div><div class="card"> <a href="/posts/networkx%E6%80%BB%E7%BB%93/"><div class="card-body"> <em class="small" data-ts="1648262040" data-df="YYYY/MM/DD" > 2022/03/26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>networkx总结</h3><div class="text-muted small"><p> 创建Graph G = nx.Graph() # 无向图 G = nx.DiGraph() # 有向图 G = nx.MultiGraph() # 多重无向图 G = nx.MultiDigraph() # 多重有向图 G.clear() # 清空图 Graph 是一组节点（顶点）和已识别的节点对（称为边、链接等）...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/networkx%E7%BB%98%E5%9B%BE/" class="btn btn-outline-primary" prompt="上一篇"><p>Networkx绘图</p></a> <a href="/posts/matlab/" class="btn btn-outline-primary" prompt="下一篇"><p>matlab</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/%E5%88%86%E7%B1%BB/">分类</a> <a class="post-tag" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">liudezhiya</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
